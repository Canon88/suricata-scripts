<var name="DEFAULT_FREQ">10</var>
<var name="DEFAULT_TIME">60</var>
<var name="DEFAULT_IGNORE">300</var>

<group name="local,suricata,ids,siem,">

    <!-- Defind Wazuh-Suricata Atomic Rules -->
    <!-- ID(Level-3): 105000 - 105999 -->

    <!-- Phase 1 Alarm START -->
    <!-- ID: 105000 - 105199 -->
    <rule id="105101" level="7" frequency="5" timeframe="30">
        <!-- ignore rule id -->
        <list field="rule.id" lookup="not_match_key">etc/lists/suricata/ignore_sid</list>

        <if_matched_sid>86611</if_matched_sid>
        <same_field>source.ip</same_field>

        <group>phase1,</group>
        <options>no_full_log</options>
        <description>Phase 1: Alarm - Same IP of attack occurred 5 times within 30 seconds. $(source.ip) -> $(destination.ip) -> $(rule.name) -> $(rule.id).</description>
    </rule>
    <!-- Phase 1 Alarm END -->

    <!-- Phase 2 Alarm START -->
    <!-- ID: 105200 - 105299 -->
    <rule id="105201" level="10" frequency="30" timeframe="300">
        <!-- ignore rule id -->
        <list field="rule.id" lookup="not_match_key">etc/lists/suricata/ignore_sid</list>

        <if_matched_sid>86611</if_matched_sid>
        <same_field>source.ip</same_field>

        <group>phase2,</group>
        <options>no_full_log</options>
        <description>Phase 2: Alarm - Same IP of attack occurred 30 times within 300 seconds. $(source.ip) -> $(destination.ip) -> $(rule.name) -> $(rule.id).</description>
    </rule>
    <!-- Phase 2 Alarm END -->

    <!-- Phase 3 Alarm START -->
    <!-- ID: 105300 - 105399 -->
    <rule id="105301" level="12" frequency="60" timeframe="900">
        <!-- ignore rule id -->
        <list field="rule.id" lookup="not_match_key">etc/lists/suricata/ignore_sid</list>

        <if_matched_sid>86611</if_matched_sid>
        <same_field>source.ip</same_field>

        <group>phase3,</group>
        <options>no_full_log</options>
        <description>Phase 3: Alarm - Same IP of attack occurred 60 times within 900 seconds. $(source.ip) -> $(destination.ip) -> $(rule.name) -> $(rule.id).</description>
    </rule>
    <!-- Phase 3 Alarm END -->

</group>